<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:pass="jakarta.faces.passthrough">

    <h:head>
        <meta charset="UTF-8"/>
        <title>FeastLink - Booking Wizard</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <!-- Tailwind CDN -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- Lucide Icons CDN -->
        <script src="https://unpkg.com/lucide@latest"></script>

        <!-- Custom animation utilities -->
        <style type="text/css">
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to   {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to   {
                    opacity: 1;
                }
            }

            @keyframes scaleIn {
                from {
                    opacity: 0;
                    transform: scale(0.95);
                }
                to   {
                    opacity: 1;
                    transform: scale(1);
                }
            }

            .animate-slideDown {
                animation: slideDown 0.3s ease-out;
            }
            .animate-fadeIn   {
                animation: fadeIn 0.4s ease-out;
            }
            .animate-scaleIn  {
                animation: scaleIn 0.3s ease-out;
            }

            html {
                scroll-behavior: smooth;
            }

            body {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .step-line-full {
                width: 100%;
            }
            .step-line-zero {
                width: 0;
            }
        </style>
    </h:head>

    <h:body class="bg-[#F9FAFB]">

        <!-- HEADER -->
        <ui:include src="/layout/header.xhtml"/>

        <h:form id="bookingForm" prependId="false">
            <!-- Global messages -->
            <h:messages globalOnly="true" style="margin-bottom:1rem;color:#b91c1c;" />

            <!-- Hidden fields nhận data từ JS -->
            <h:inputHidden id="hf-restaurant-id"
                           value="#{customerBookingBean.restaurantId}" />
            <h:inputHidden id="hf-event-date"
                           value="#{customerBookingBean.eventDateStr}" />
            <h:inputHidden id="hf-event-type"
                           value="#{customerBookingBean.eventTypeKey}" />
            <h:inputHidden id="hf-service-level"
                           value="#{customerBookingBean.serviceLevel}" />
            <h:inputHidden id="hf-guest-count"
                           value="#{customerBookingBean.guestCount}" />
            <h:inputHidden id="hf-location-type"
                           value="#{customerBookingBean.locationType}" />
            <h:inputHidden id="hf-outside-address"
                           value="#{customerBookingBean.outsideAddress}" />
            <h:inputHidden id="hf-total-amount"
                           value="#{customerBookingBean.totalAmount}" />
            <h:inputHidden id="hf-deposit-amount"
                           value="#{customerBookingBean.depositAmount}" />
            <h:inputHidden id="hf-remaining-amount"
                           value="#{customerBookingBean.remainingAmount}" />

            <!-- Voucher hidden fields (sync from booking.js) -->
            <h:inputHidden id="hf-voucher-code"
                           value="#{customerBookingBean.voucherCode}" />
            <h:inputHidden id="hf-total-before-discount"
                           value="#{customerBookingBean.totalBeforeDiscount}" />
            <h:inputHidden id="hf-voucher-discount"
                           value="#{customerBookingBean.voucherDiscount}" />


            <!-- NEW: giữ id combo & id các món custom menu giữa các request -->
            <h:inputHidden id="hf-combo-id"
                           value="#{customerBookingBean.selectedComboId}" />
            <h:inputHidden id="hf-menu-items"
                           value="#{customerBookingBean.selectedMenuItemIds}" />



            <h:inputHidden id="hf-start-time" value="#{customerBookingBean.startTimeStr}" />
            <h:inputHidden id="hf-end-time"   value="#{customerBookingBean.endTimeStr}" />



            <input type="hidden" id="hf-payment-method" name="hf-payment-method" value=""/>
            <input type="hidden" id="hf-payment-type"   name="hf-payment-type"   value=""/>
            <input type="hidden" id="hf-pay-amount"     name="hf-pay-amount"     value=""/>





            <main id="booking" class="pt-28 pb-16 min-h-screen bg-[#F9FAFB]">
                <div class="max-w-[1280px] mx-auto px-4 lg:px-6">
                    <h:panelGroup rendered="#{empty sessionScope.currentUser}">
                        <div class="mb-6 rounded-2xl border border-[#F97316]/30 bg-[#FFFBEB] px-4 py-3 md:px-5 md:py-4 flex gap-3">
                            <div class="mt-1">
                                <i data-lucide="lock-keyhole" class="w-5 h-5 text-[#EA580C]"></i>
                            </div>
                            <div class="text-sm text-[#78350F]">
                                <p class="font-semibold mb-1">
                                    You need to sign in to complete your booking.
                                </p>
                                <ul class="list-disc pl-5 space-y-1 text-xs md:text-sm">
                                    <li>View your full booking history and payment status.</li>
                                    <li>Manage, modify, or cancel your bookings easily.</li>
                                    <li>Save your contact details for faster future bookings.</li>
                                </ul>
                                <div class="mt-3 flex flex-wrap gap-2">
                                    <h:link outcome="/login"
                                            styleClass="inline-flex items-center gap-2 px-4 py-2 rounded-xl text-xs md:text-sm font-semibold bg-[#020617] text-white">
                                        Sign in to continue
                                    </h:link>
                                    <h:link outcome="/register"
                                            styleClass="inline-flex items-center gap-2 px-4 py-2 rounded-xl text-xs md:text-sm font-semibold border border-[#020617] text-[#020617]">
                                        Create a new account
                                    </h:link>
                                </div>
                            </div>
                        </div>
                    </h:panelGroup>

                    <!-- STEPPER -->
                    <div class="w-full mb-12">
                        <div class="flex items-center relative max-w-3xl mx-auto" id="stepper">
                            <!-- Step 1 -->
                            <div class="flex flex-col items-center relative z-10">
                                <div
                                    class="step-circle w-12 h-12 rounded-full flex items-center justify-center font-semibold text-base transition-all duration-300 relative bg-[#020617] text-white ring-4 ring-[#D4AF37]/30 shadow-lg">
                                    1
                                </div>
                                <span
                                    class="mt-3 text-sm font-medium transition-colors duration-300 text-center whitespace-nowrap text-[#111827]">
                                    Event &amp; Package
                                </span>
                            </div>

                            <!-- Line 1-2 -->
                            <div class="flex-1 mx-4 relative" style="height:2px; margin-top:-32px;">
                                <div class="absolute inset-0 bg-[#E5E7EB] rounded-full"></div>
                                <div
                                    class="step-line step-line-zero absolute inset-0 rounded-full transition-all duration-500 bg-[#D4AF37]">
                                </div>
                            </div>

                            <!-- Step 2 -->
                            <div class="flex flex-col items-center relative z-10">
                                <div
                                    class="step-circle w-12 h-12 rounded-full flex items-center justify-center font-semibold text-base transition-all duration-300 relative bg-white text-[#9CA3AF] border-2 border-[#E5E7EB]">
                                    2
                                </div>
                                <span
                                    class="mt-3 text-sm font-medium transition-colors duration-300 text-center whitespace-nowrap text-[#4B5563]">
                                    Guest &amp; Requests
                                </span>
                            </div>

                            <!-- Line 2-3 -->
                            <div class="flex-1 mx-4 relative" style="height:2px; margin-top:-32px;">
                                <div class="absolute inset-0 bg-[#E5E7EB] rounded-full"></div>
                                <div
                                    class="step-line step-line-zero absolute inset-0 rounded-full transition-all duration-500 bg-[#D4AF37]">
                                </div>
                            </div>

                            <!-- Step 3 -->
                            <div class="flex flex-col items-center relative z-10">
                                <div
                                    class="step-circle w-12 h-12 rounded-full flex items-center justify-center font-semibold text-base transition-all duration-300 relative bg-white text-[#9CA3AF] border-2 border-[#E5E7EB]">
                                    3
                                </div>
                                <span
                                    class="mt-3 text-sm font-medium transition-colors duration-300 text-center whitespace-nowrap text-[#4B5563]">
                                    Payment
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- MAIN GRID -->
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">

                        <!-- LEFT: Steps content -->
                        <div class="lg:col-span-7 space-y-6">

                            <!-- STEP 1 -->
                            <section id="step-1"
                                     class="transition-all duration-500 animate-fadeIn">
                                <!-- Card: Event details -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Event details</h3>
                                    </div>
                                    <div class="p-8 space-y-6">
                                        <!-- Venue info -->
                                        <div class="flex items-start justify-between pb-6 border-b border-[#E5E7EB]">
                                            <div class="flex-1">
                                                <h4 class="text-lg font-semibold text-[#111827] mb-2"
                                                    id="venue-name">
                                                    <h:outputText value="#{customerBookingBean.restaurantName}" />
                                                </h4>

                                                <div class="flex items-center gap-4 text-sm">
                                                    <div class="flex items-center gap-1">
                                                        <span class="text-[#D4AF37]">★</span>

                                                        <span class="font-medium text-[#111827]" id="venue-rating">
                                                            <h:panelGroup rendered="#{not empty restaurantDetailsBean.avgRating}">
                                                                <h:outputText value="#{restaurantDetailsBean.avgRating}">
                                                                    <f:convertNumber maxFractionDigits="1" minFractionDigits="1"/>
                                                                </h:outputText>
                                                            </h:panelGroup>

                                                            <h:panelGroup rendered="#{empty restaurantDetailsBean.avgRating}">
                                                                <span class="text-[#6B7280]">New</span>
                                                            </h:panelGroup>
                                                        </span>
                                                    </div>

                                                    <div class="flex items-center gap-1 text-[#4B5563]">
                                                        <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                        <span id="venue-location">
                                                            <h:outputText value="#{customerBookingBean.restaurantAddress}" />
                                                        </span>
                                                    </div>
                                                </div>

                                                <div class="flex gap-2 mt-3 flex-wrap" id="venue-tags">
                                                    <span
                                                        class="px-3 py-1 bg-[#F9FAFB] border border-[#E5E7EB] rounded-full text-xs font-medium text-[#4B5563]">
                                                        Top rated
                                                    </span>
                                                    <span
                                                        class="px-3 py-1 bg-[#F9FAFB] border border-[#E5E7EB] rounded-full text-xs font-medium text-[#4B5563]">
                                                        Rooftop
                                                    </span>
                                                    <span
                                                        class="px-3 py-1 bg-[#F9FAFB] border border-[#E5E7EB] rounded-full text-xs font-medium text-[#4B5563]">
                                                        VIP Partner
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Date & time -->
                                        <div class="pb-6 border-b border-[#E5E7EB]">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center gap-3">
                                                    <i data-lucide="calendar" class="w-5 h-5 text-[#D4AF37]"></i>
                                                    <div>
                                                        <p class="text-sm text-[#4B5563]">Event date &amp; time</p>
                                                        <p class="font-medium text-[#111827]">
                                                            <h:outputText id="eventDateText"
                                                                          value="#{customerBookingBean.eventDateDisplay}" />
                                                        </p>
                                                    </div>
                                                </div>

                                                <button type="button"
                                                        id="btn-change-datetime"
                                                        class="text-sm text-[#D4AF37] hover:text-[#E6C77F] underline">
                                                    Change date &amp; time
                                                </button>
                                            </div>

                                            <!-- time dropdowns -->
                                            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-[#111827] mb-2">Start time</label>
                                                    <h:selectOneMenu id="startTime"
                                                                     value="#{customerBookingBean.startTimeStr}"
                                                                     styleClass="w-full px-4 py-3 rounded-xl border border-[#E5E7EB] bg-white
                                                                     text-[#111827] focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-transparent">
                                                        <f:ajax listener="#{customerBookingBean.onStartTimeChange}"
                                                                render="endTime hf-start-time hf-end-time" />
                                                        <f:selectItems value="#{customerBookingBean.startTimeOptions}"
                                                                       var="t" itemValue="#{t}" itemLabel="#{t}" />
                                                    </h:selectOneMenu>
                                                </div>

                                                <div>
                                                    <label class="block text-sm font-medium text-[#111827] mb-2">End time</label>
                                                    <h:selectOneMenu id="endTime"
                                                                     value="#{customerBookingBean.endTimeStr}"
                                                                     styleClass="w-full px-4 py-3 rounded-xl border border-[#E5E7EB] bg-white
                                                                     text-[#111827] focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-transparent">
                                                        <f:ajax render="hf-end-time" />
                                                        <f:selectItems value="#{customerBookingBean.endTimeOptions}"
                                                                       var="t" itemValue="#{t}" itemLabel="#{t}" />
                                                    </h:selectOneMenu>
                                                </div>
                                            </div>
                                        </div>



                                        <!-- Event type -->
                                        <div>
                                            <label  
                                                class="block text-sm font-medium text-[#111827] mb-2">Event
                                                type</label>
                                            <div class="relative">
                                                <h:selectOneMenu value="#{customerBookingBean.selectedEventTypeId}"
                                                                 styleClass="w-full px-4 py-3 rounded-xl border border-[#E5E7EB] bg-white 
                                                                 text-[#111827] focus:outline-none focus:ring-2 
                                                                 focus:ring-[#D4AF37] focus:border-transparent">
                                                    <f:ajax listener="#{customerBookingBean.onEventTypeChange}"
                                                            render="summaryEventType" />

                                                    <f:selectItem itemLabel="Select event type"
                                                                  itemValue=""
                                                                  noSelectionOption="true" />

                                                    <f:selectItems value="#{eventTypesPublicBean.eventTypes}"
                                                                   var="et"
                                                                   itemValue="#{et.eventTypeId}"
                                                                   itemLabel="#{et.name}"/>
                                                </h:selectOneMenu>




                                                <i data-lucide="chevron-down"
                                                   class="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#4B5563] pointer-events-none"></i>
                                            </div>
                                        </div>

                                        <!-- Service level -->
                                        <div>
                                            <label
                                                class="block text-sm font-medium text-[#111827] mb-3">Service
                                                level</label>
                                            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3"
                                                 id="service-level-buttons">

                                                <!-- Standard -->
                                                <button type="button"
                                                        data-level="standard"
                                                        class="service-level-btn px-4 py-3 rounded-xl font-medium text-sm transition-all duration-200 bg-white text-[#4B5563] border-2 border-[#E5E7EB] hover:border-[#D4AF37]">
                                                    <div class="flex flex-col items-start">
                                                        <span>Standard</span>
                                                        <span class="mt-1 text-xs text-[#6B7280]"
                                                              id="service-level-price-standard"></span>
                                                    </div>
                                                </button>

                                                <!-- Premium -->
                                                <button type="button"
                                                        data-level="premium"
                                                        class="service-level-btn px-4 py-3 rounded-xl font-medium text-sm transition-all duration-200 bg-white text-[#4B5563] border-2 border-[#E5E7EB] hover:border-[#D4AF37]">
                                                    <div class="flex flex-col items-start">
                                                        <span>Premium</span>
                                                        <span class="mt-1 text-xs text-[#6B7280]"
                                                              id="service-level-price-premium"></span>
                                                    </div>
                                                </button>

                                                <!-- VIP -->
                                                <button type="button"
                                                        data-level="vip"
                                                        class="service-level-btn px-4 py-3 rounded-xl font-medium text-sm transition-all duration-200 bg-white text-[#4B5563] border-2 border-[#E5E7EB] hover:border-[#D4AF37]">
                                                    <div class="flex flex-col items-start">
                                                        <span>VIP</span>
                                                        <span class="mt-1 text-xs text-[#6B7280]"
                                                              id="service-level-price-vip"></span>
                                                    </div>
                                                </button>

                                                <!-- Exclusive -->
                                                <button type="button"
                                                        data-level="exclusive"
                                                        class="service-level-btn px-4 py-3 rounded-xl font-medium text-sm transition-all duration-200 bg-white text-[#4B5563] border-2 border-[#E5E7EB] hover:border-[#D4AF37]">
                                                    <div class="flex flex-col items-start">
                                                        <span>Exclusive</span>
                                                        <span class="mt-1 text-xs text-[#6B7280]"
                                                              id="service-level-price-exclusive"></span>
                                                    </div>
                                                </button>
                                            </div>

                                        </div>

                                        <!-- Number of guests -->
                                        <div>
                                            <label class="block text-sm font-medium text-[#111827] mb-3">
                                                Number of guests
                                            </label>

                                            <div class="flex items-center gap-4">
                                                <button type="button" id="btn-minus-guest"
                                                        class="w-10 h-10 rounded-xl border-2 border-[#E5E7EB] hover:border-[#D4AF37]
                                                        text-[#4B5563] hover:text-[#D4AF37] transition-colors flex items-center justify-center">
                                                    -
                                                </button>

                                                <div class="flex-1 text-center">
                                                    <input type="number" id="guest-count-input"  min="#{customerBookingBean.guestMin}"
                                                           max="#{customerBookingBean.guestMax}"
                                                           value="#{customerBookingBean.guestCount}"
                                                           inputmode="numeric"
                                                           class="w-full text-3xl font-bold text-[#111827] text-center bg-transparent border-0
                                                           focus:outline-none focus:ring-0"/>

                                                    <div id="capacity-status" class="text-xs text-gray-400">
                                                        Allowed: #{customerBookingBean.guestMin}–#{customerBookingBean.guestMax} guests
                                                    </div>


                                                    <div class="text-xs text-[#4B5563] mt-1" id="guest-count-label">
                                                        (~20 tables at 10 guests/table)
                                                    </div>
                                                </div>

                                                <button type="button" id="btn-plus-guest"
                                                        class="w-10 h-10 rounded-xl border-2 border-[#E5E7EB] hover:border-[#D4AF37]
                                                        text-[#4B5563] hover:text-[#D4AF37] transition-colors flex items-center justify-center">
                                                    +
                                                </button>
                                            </div>
                                        </div>


                                        <!-- Location type -->
                                        <div>
                                            <label
                                                class="block text-sm font-medium text-[#111827] mb-3">Location
                                                type</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4"
                                                 id="location-type-buttons">
                                                <button type="button"
                                                        data-location="restaurant"
                                                        class="location-btn p-6 rounded-xl border-2 transition-all duration-200 text-left border-[#D4AF37] bg-[#D4AF37]/5">
                                                    <div class="font-semibold text-[#111827] mb-1">At restaurant</div>
                                                    <div class="text-sm text-[#4B5563]">Host your event at our
                                                        venue
                                                    </div>
                                                </button>
                                                <button type="button"
                                                        data-location="outside"
                                                        class="location-btn p-6 rounded-xl border-2 transition-all duration-200 text-left border-[#E5E7EB] hover:border-[#D4AF37]">
                                                    <div class="font-semibold text-[#111827] mb-1">Outside
                                                        catering
                                                    </div>
                                                    <div class="text-sm text-[#4B5563]">We cater at your
                                                        location
                                                    </div>
                                                </button>
                                            </div>

                                            <!-- Outside address -->
                                            <div id="outside-address-wrapper"
                                                 class="hidden mt-4 p-6 bg-[#F9FAFB] rounded-xl border border-[#E5E7EB] space-y-4">
                                                <div class="flex items-start gap-2 text-sm text-[#4B5563] mb-4">
                                                    <i data-lucide="alert-circle"
                                                       class="w-5 h-5 text-[#EAB308] flex-shrink-0 mt-0.5"></i>
                                                    <span>Travel fee may apply for outside catering.</span>
                                                </div>
                                                <div class="grid grid-cols-1 gap-4">
                                                    <input id="outside-street" type="text"
                                                           placeholder="Street address"
                                                           class="px-4 py-3 rounded-xl border border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none"/>
                                                    <div class="grid grid-cols-2 gap-4">
                                                        <input id="outside-area" type="text" placeholder="Area"
                                                               class="px-4 py-3 rounded-xl border border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none"/>
                                                        <input id="outside-city" type="text" placeholder="City"
                                                               class="px-4 py-3 rounded-xl border border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Package & menu -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Package &amp; menu</h3>
                                    </div>
                                    <div class="p-8 space-y-6">
                                        <!-- Package highlight -->
                                        <div id="package-card"
                                             class="p-6 bg-gradient-to-r from-[#020617] to-[#0B1120] rounded-xl border-2 border-[#D4AF37]">
                                            <div class="flex items-start justify-between mb-4">
                                                <div>
                                                    <div class="flex items-center gap-3 mb-2">
                                                        <h4 class="text-xl font-bold text-white"
                                                            id="package-name">
                                                            Royal Wedding Package
                                                        </h4>
                                                        <span
                                                            class="px-3 py-1 bg-[#D4AF37] text-[#020617] rounded-full text-xs font-bold"
                                                            id="package-badge">
                                                            VIP
                                                        </span>
                                                    </div>
                                                    <p class="text-sm text-[#E6C77F]" id="package-guest-range">
                                                        Ideal for 150–300 guests
                                                    </p>
                                                </div>
                                                <div class="text-2xl font-bold text-[#D4AF37]"
                                                     id="package-price">
                                                    $1,200
                                                </div>
                                                <div class="text-sm text-[#E6C77F]">per guest</div>

                                            </div>
                                        </div>
                                        <!-- Empty state when no package is selected -->
                                        <div id="no-package-selected"
                                             class="hidden p-6 rounded-xl border border-dashed border-[#E5E7EB] bg-[#F9FAFB] text-sm text-[#4B5563]">
                                            <p class="font-semibold text-[#111827] mb-1">
                                                No package selected yet.
                                            </p>
                                            <p>
                                                You can go back to the restaurant details page and choose a menu package,
                                                then select an available date to continue your booking.
                                            </p>
                                        </div>

                                        <!-- Included dishes -->
                                        <div>
                                            <h5 class="font-semibold text-[#111827] mb-3">Included dishes</h5>
                                            <ul class="space-y-2" id="package-dishes">
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    Premium welcome cocktail with canapés
                                                </li>
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    12-course royal banquet menu
                                                </li>
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    Wagyu beef &amp; lobster main course
                                                </li>
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    French dessert tower
                                                </li>
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    Premium wine &amp; champagne pairing
                                                </li>
                                                <li
                                                    class="flex items-start gap-2 text-sm text-[#4B5563]">
                                                    <span class="text-[#D4AF37] mt-1">✓</span>
                                                    Traditional wedding cake ceremony
                                                </li>
                                            </ul>
                                            <button type="button"
                                                    id="view-full-menu-btn"
                                                    class="text-...7] hover:text-[#E6C77F] underline mt-3 flex items-center gap-1">
                                                View full menu details
                                                <i data-lucide="chevron-down"
                                                   class="w-4 h-4 transition-transform duration-200"></i>
                                            </button>
                                            <!-- Full custom menu details (à la carte) -->
                                            <h:panelGroup rendered="#{not empty customerBookingBean.selectedMenuItems}">
                                                <div id="full-menu-details-panel"
                                                     class="mt-3 hidden rounded-2xl border border-[#E5E7EB] bg-[#F9FAFB] p-4">
                                                    <div class="flex items-center justify-between mb-2">
                                                        <p class="text-sm font-semibold text-[#111827]">
                                                            Custom menu (à la carte)
                                                        </p>
                                                        <span class="text-[11px] font-medium text-[#6B7280]">
                                                            #{customerBookingBean.selectedMenuItems.size()} dishes
                                                        </span>
                                                    </div>

                                                    <div class="max-h-64 overflow-y-auto space-y-1.5 pr-1">
                                                        <ui:repeat value="#{customerBookingBean.selectedMenuItems}" var="dish">
                                                            <div class="flex items-center justify-between text-[11px] text-[#4B5563]">
                                                                <div class="flex-1 min-w-0">
                                                                    <p class="truncate font-medium text-[#111827]">
                                                                        #{dish.name}
                                                                    </p>
                                                                    <h:panelGroup rendered="#{not empty dish.categoryId}">
                                                                        <p class="truncate text-[10px] text-[#9CA3AF]">
                                                                            #{dish.categoryId.name}
                                                                        </p>
                                                                    </h:panelGroup>
                                                                </div>
                                                                <p class="ml-2 whitespace-nowrap font-semibold text-[#B45309]">
                                                                    $#{dish.pricePerPerson}
                                                                </p>
                                                            </div>
                                                        </ui:repeat>
                                                    </div>
                                                </div>
                                                <!-- Hidden price data for JS -->
                                                <h:panelGroup layout="block" style="display:none;">
                                                    <ui:repeat value="#{customerBookingBean.selectedMenuItems}" var="dish">
                                                        <span class="js-menu-dish-price"
                                                              data-price="#{dish.pricePerPerson}"></span>
                                                    </ui:repeat>
                                                </h:panelGroup>

                                            </h:panelGroup>


                                        </div>


                                    </div>
                                </div>

                                <!-- Step 1 buttons -->
                                <div class="flex items-center justify-between pt-6">
                                    <button type="button"
                                            class="text-sm text-[#4B5563] hover:text-[#111827] underline">
                                        Back to restaurant details
                                    </button>
                                    <button type="button" id="btn-step1-next"
                                            class="font-medium rounded-xl transition-all duration-300 bg-gradient-to-r from-orange-500 to-yellow-500 text-white hover:shadow-lg hover:shadow-orange-500/30 hover:scale-[1.02] active:scale-[0.98] px-12 py-4 text-lg">
                                        Continue to Guest details
                                    </button>
                                </div>
                            </section>

                            <!-- STEP 2 -->
                            <section id="step-2"
                                     class="hidden transition-all duration-500">
                                <!-- Card: Contact info -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Contact information</h3>
                                    </div>
                                    <div class="p-8 space-y-5">
                                        <!-- Full name -->
                                        <div class="w-full">
                                            <label
                                                class="block text-sm font-medium text-[#111827] mb-2">Full
                                                name</label>
                                            <h:inputText id="contact-fullname"
                                                         value="#{customerBookingBean.contactFullName}"
                                                         styleClass="w-full px-4 py-3 rounded-xl border bg-white transition-all duration-200 border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none text-[#111827] placeholder:text-[#9CA3AF]"
                                                         pass:placeholder="Enter your full name"
                                                         required="true"
                                                         requiredMessage="Please enter your full name"/>
                                            <h:message for="contact-fullname"
                                                       style="margin-top:6px;color:#EF4444;font-size:13px;display:block;"/>


                                        </div>

                                        <!-- Email -->
                                        <div class="w-full">
                                            <label
                                                class="block text-sm font-medium text-[#111827] mb-2">Email
                                                address</label>
                                            <h:inputText id="contact-email"
                                                         value="#{customerBookingBean.contactEmail}"
                                                         styleClass="w-full px-4 py-3 rounded-xl border bg-white transition-all duration-200 border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none text-[#111827] placeholder:text-[#9CA3AF]"
                                                         pass:placeholder="your.email@example.com"
                                                         pass:type="email"
                                                         required="true"
                                                         requiredMessage="Please enter your email"/>
                                            <h:message for="contact-email"
                                                       style="margin-top:6px;color:#EF4444;font-size:13px;display:block;"/>


                                            <!-- có thể giữ lại helper nếu thích -->
                                            <p id="contact-email-error"
                                               class="mt-1.5 text-sm text-[#EF4444] hidden">
                                                ⚠ Please enter a valid email address
                                            </p>
                                        </div>

                                        <!-- Phone -->
                                        <div class="w-full">
                                            <label
                                                class="block text-sm font-medium text-[#111827] mb-2">Phone
                                                number</label>
                                            <h:inputText id="contact-phone"
                                                         value="#{customerBookingBean.contactPhone}"
                                                         styleClass="w-full px-4 py-3 rounded-xl border bg-white transition-all duration-200 border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none text-[#111827] placeholder:text-[#9CA3AF]"
                                                         pass:placeholder="+84 123 456 789"
                                                         required="true"
                                                         requiredMessage="Please enter your phone number"/>
                                            <h:message for="contact-phone"
                                                       style="margin-top:6px;color:#EF4444;font-size:13px;display:block;"/>


                                            <p id="contact-phone-helper"
                                               class="mt-1.5 text-sm text-[#4B5563]">
                                                Include country code for international numbers
                                            </p>
                                        </div>



                                    </div>
                                </div>

                                <!-- Card: Special services & requests -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">
                                            Special services &amp; requests
                                        </h3>
                                    </div>
                                    <div class="p-8 space-y-6">
                                        <!--                                         Additional services 
                                                                                <div>
                                                                                    <h5 class="font-medium text-[#111827] mb-4">Additional services</h5>
                                                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="special-services">
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                Decoration &amp; styling
                                                                                            </span>
                                                                                        </label>
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                Premium AV &amp; lighting
                                                                                            </span>
                                                                                        </label>
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                MC &amp; event host
                                                                                            </span>
                                                                                        </label>
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                Live band / music
                                                                                            </span>
                                                                                        </label>
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                Photo &amp; video team
                                                                                            </span>
                                                                                        </label>
                                                                                        <label class="flex items-start gap-3 cursor-pointer group">
                                                                                            <div class="relative flex-shrink-0 mt-0.5">
                                                                                                <input type="checkbox" class="sr-only"/>
                                                                                                <div
                                                                                                    class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium text-[#111827]">
                                                                                                Vegetarian / halal / special diet
                                                                                            </span>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>-->

                                        <!-- Special requests -->
                                        <div class="pt-6 border-t border-[#E5E7EB]">
                                            <div class="w-full">
                                                <label
                                                    class="block text-sm font-medium text-[#111827] mb-2">Special
                                                    requests</label>
                                                <textarea id="special-requests" name="special-requests" rows="6"
                                                          placeholder="Tell us about your theme, timeline, program flow, or any special requests…"
                                                          class="w-full px-4 py-3 rounded-xl border bg-white transition-all duration-200 border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none text-[#111827] placeholder:text-[#9CA3AF] resize-none"></textarea>
                                            </div>

                                            <div
                                                class="mt-4 p-4 bg-[#020617] border-2 border-[#D4AF37] rounded-xl">
                                                <p class="text-sm text-[#E6C77F] flex items-start gap-2">
                                                    <i data-lucide="file-text"
                                                       class="w-5 h-5 flex-shrink-0 mt-0.5"></i>
                                                    <span>FeastLink consultants may contact you to suggest menu and décor options based on your notes.</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Booking policies -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Booking policies</h3>
                                    </div>
                                    <div class="p-8 space-y-6">
                                        <!-- small cards -->
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div
                                                class="p-5 bg-[#F9FAFB] rounded-xl border border-[#E5E7EB]">
                                                <div class="flex items-center gap-2 mb-2">
                                                    <i data-lucide="check-circle"
                                                       class="w-5 h-5 text-[#22C55E]"></i>
                                                    <h6 class="font-semibold text-[#111827]">Advance booking
                                                    </h6>
                                                </div>
                                                <p class="text-sm text-[#4B5563]">Min. 30 days before event
                                                </p>
                                            </div>
                                            <div
                                                class="p-5 bg-[#F9FAFB] rounded-xl border border-[#E5E7EB]">
                                                <div class="flex items-center gap-2 mb-2">
                                                    <i data-lucide="check-circle"
                                                       class="w-5 h-5 text-[#22C55E]"></i>
                                                    <h6 class="font-semibold text-[#111827]">Deposit</h6>
                                                </div>
                                                <p class="text-sm text-[#4B5563]">30% required to confirm</p>
                                            </div>
                                            <div
                                                class="p-5 bg-[#F9FAFB] rounded-xl border border-[#E5E7EB]">
                                                <div class="flex items-center gap-2 mb-2">
                                                    <i data-lucide="check-circle"
                                                       class="w-5 h-5 text-[#22C55E]"></i>
                                                    <h6 class="font-semibold text-[#111827]">Remaining payment
                                                    </h6>
                                                </div>
                                                <p class="text-sm text-[#4B5563]">Due 7 days before event</p>
                                            </div>
                                        </div>

                                        <!-- Cancellation policy -->
                                        <div
                                            class="p-5 bg-[#FEF3C7] border-2 border-[#FACC15] rounded-xl">
                                            <h6
                                                class="font-semibold text-[#111827] mb-3 flex items-center gap-2">
                                                <i data-lucide="alert-circle"
                                                   class="w-5 h-5 text-[#EAB308]"></i>
                                                Cancellation policy
                                            </h6>
                                            <ul class="space-y-2 text-sm">
                                                <li class="flex items-start gap-2">
                                                    <i data-lucide="check-circle"
                                                       class="w-4 h-4 text-[#22C55E] flex-shrink-0 mt-0.5"></i>
                                                    <span class="text-[#4B5563]"><strong>Free cancellation</strong> until 21 days before event</span>
                                                </li>
                                                <li class="flex items-start gap-2">
                                                    <i data-lucide="alert-circle"
                                                       class="w-4 h-4 text-[#FACC15] flex-shrink-0 mt-0.5"></i>
                                                    <span class="text-[#4B5563]"><strong>50% penalty</strong> if cancelled 7–21 days before event</span>
                                                </li>
                                                <li class="flex items-start gap-2">
                                                    <i data-lucide="alert-circle"
                                                       class="w-4 h-4 text-[#EF4444] flex-shrink-0 mt-0.5"></i>
                                                    <span class="text-[#4B5563]"><strong>No refund</strong> if cancelled less than 7 days before event</span>
                                                </li>
                                            </ul>
                                        </div>

                                        <!-- Accept terms -->
                                        <div class="pt-6 border-t border-[#E5E7EB]">
                                            <label
                                                class="flex items-start gap-3 cursor-pointer group">
                                                <div class="relative flex-shrink-0 mt-0.5">
                                                    <input id="accept-policies" type="checkbox"
                                                           class="sr-only"/>
                                                    <div id="accept-policies-box"
                                                         class="w-5 h-5 rounded border-2 transition-all duration-200 bg-white border-[#E5E7EB] group-hover:border-[#D4AF37]">
                                                    </div>
                                                </div>
                                                <div class="flex-1">
                                                    <span class="text-sm font-medium text-[#111827]">
                                                        I have read and agree to the booking terms, cancellation policy and privacy policy
                                                    </span>
                                                    <p class="text-sm text-[#4B5563] mt-0.5">
                                                        By checking this box, you confirm your understanding and
                                                        acceptance of all terms.
                                                    </p>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Step 2 buttons -->
                                <div class="flex items-center justify-between pt-6">
                                    <button type="button" id="btn-step2-back"
                                            class="font-medium rounded-xl transition-all duration-300 border-2 border-[#D4AF37] text-[#D4AF37] bg-transparent hover:bg-[#D4AF37]/10 px-6 py-3 text-base">
                                        Back to Event &amp; Package
                                    </button>
                                    <button type="button" id="btn-step2-next"
                                            class="font-medium rounded-xl transition-all duration-300 bg-gradient-to-r from-orange-500 to-yellow-500 text-white hover:shadow-lg hover:shadow-orange-500/30 hover:scale-[1.02] active:scale-[0.98] px-12 py-4 text-lg disabled:opacity-50 disabled:cursor-not-allowed">
                                        Continue to Payment
                                    </button>
                                </div>
                            </section>

                            <!-- STEP 3 -->
                            <section id="step-3"
                                     class="hidden transition-all duration-500">
                                <!-- Card: Choose payment method -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Choose payment method</h3>
                                    </div>
                                    <div class="p-8">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="payment-methods">
                                            <!-- Card -->
                                            <button type="button" data-method="card"
                                                    class="payment-method p-6 rounded-xl border-2 transition-all duration-200 text-left relative border-[#D4AF37] bg-[#020617] text-white">
                                                <span
                                                    class="absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-bold bg-[#D4AF37] text-[#020617]">
                                                    Recommended
                                                </span>
                                                <div class="mb-3 text-[#D4AF37]">
                                                    <i data-lucide="credit-card" class="w-6 h-6"></i>
                                                </div>
                                                <h5 class="font-semibold mb-1">
                                                    Credit / Debit Card
                                                </h5>
                                                <p class="text-sm text-[#E6C77F]">
                                                    Instant confirmation
                                                </p>
                                            </button>

                                            <!-- Bank transfer -->
                                            <button type="button" data-method="bank"
                                                    class="payment-method p-6 rounded-xl border-2 transition-all duration-200 text-left relative border-[#E5E7EB] bg-white hover:border-[#D4AF37]">
                                                <div class="mb-3 text-[#4B5563]">
                                                    <i data-lucide="building" class="w-6 h-6"></i>
                                                </div>
                                                <h5 class="font-semibold mb-1 text-[#111827]">
                                                    Bank Transfer
                                                </h5>
                                                <p class="text-sm text-[#4B5563]">
                                                    Processing time: 1–2 days
                                                </p>
                                            </button>

                                            <!-- E-wallet -->
                                            <button type="button" data-method="ewallet"
                                                    class="payment-method p-6 rounded-xl border-2 transition-all duration-200 text-left relative border-[#E5E7EB] bg-white hover:border-[#D4AF37]">
                                                <span
                                                    class="absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-bold bg-[#F9FAFB] text-[#4B5563]">
                                                    No extra fee
                                                </span>
                                                <div class="mb-3 text-[#4B5563]">
                                                    <i data-lucide="smartphone" class="w-6 h-6"></i>
                                                </div>
                                                <h5 class="font-semibold mb-1 text-[#111827]">
                                                    E-wallet
                                                </h5>
                                                <p class="text-sm text-[#4B5563]">
                                                    Momo, ZaloPay
                                                </p>
                                            </button>

                                            <!-- Pay at venue -->
                                            <button type="button" data-method="venue"
                                                    class="payment-method p-6 rounded-xl border-2 transition-all duration-200 text-left relative border-[#E5E7EB] bg-white hover:border-[#D4AF37]">
                                                <div class="mb-3 text-[#4B5563]">
                                                    <i data-lucide="store" class="w-6 h-6"></i>
                                                </div>
                                                <h5 class="font-semibold mb-1 text-[#111827]">
                                                    Pay at venue
                                                </h5>
                                                <p class="text-sm text-[#4B5563]">
                                                    Subject to approval
                                                </p>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Payment amount -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Payment amount</h3>
                                    </div>
                                    <div class="p-8 space-y-4" id="payment-type-wrapper">
                                        <!-- Deposit -->
                                        <button type="button" data-type="deposit"
                                                class="pay-type w-full p-6 rounded-xl border-2 transition-all duration-200 text-left border-[#D4AF37] bg-[#D4AF37]/5">
                                            <div class="flex items-start justify-between mb-2">
                                                <div class="flex items-center gap-3">
                                                    <div
                                                        class="radio-outer w-5 h-5 rounded-full border-2 flex items-center justify-center border-[#D4AF37]">
                                                        <div class="radio-inner w-3 h-3 rounded-full bg-[#D4AF37]"></div>
                                                    </div>
                                                    <div>
                                                        <h6 class="font-semibold text-[#111827]">
                                                            Pay deposit only (30%)
                                                        </h6>
                                                        <p class="text-sm text-[#4B5563] mt-1">
                                                            Remaining amount due 7 days before event
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-4 p-4 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]">
                                                <p class="text-sm text-[#4B5563]">
                                                    Your booking will be confirmed after deposit is received. The
                                                    remaining balance must be paid before the specified due date.
                                                </p>
                                            </div>
                                        </button>

                                        <!-- Full -->
                                        <button type="button" data-type="full"
                                                class="pay-type w-full p-6 rounded-xl border-2 transition-all duration-200 text-left border-[#E5E7EB] hover:border-[#D4AF37]">
                                            <div class="flex items-start justify-between">
                                                <div class="flex items-center gap-3">
                                                    <div
                                                        class="radio-outer w-5 h-5 rounded-full border-2 flex items-center justify-center border-[#E5E7EB]">
                                                    </div>
                                                    <div>
                                                        <h6 class="font-semibold text-[#111827]">
                                                            Pay full amount now
                                                        </h6>
                                                        <p class="text-sm text-[#4B5563] mt-1">
                                                            Fast confirmation, priority support
                                                        </p>
                                                    </div>
                                                </div>
                                                <span
                                                    class="px-3 py-1 bg-[#22C55E] text-white rounded-full text-xs font-bold">
                                                    Recommended
                                                </span>
                                            </div>
                                        </button>
                                    </div>
                                </div>

                                <!-- Card: Promotion code -->
                                <div class="bg-white rounded-[24px] shadow-sm border border-[#E5E7EB] overflow-hidden mb-6">
                                    <div class="px-8 py-6 border-b border-[#E5E7EB]">
                                        <h3 class="text-xl font-semibold text-[#111827]">Promotion code</h3>
                                    </div>
                                    <div class="p-8 space-y-3">
                                        <div class="flex gap-3">
                                            <div class="flex-1 relative">
                                                <i data-lucide="tag"
                                                   class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#4B5563]"></i>
                                                <input id="voucher-input" type="text"
                                                       placeholder="Enter voucher or promotion code"
                                                       class="w-full pl-12 pr-4 py-3 rounded-xl border border-[#E5E7EB] focus:border-[#D4AF37] focus:ring-2 focus:ring-[#D4AF37]/20 focus:outline-none"/>
                                            </div>
                                            <button type="button" id="btn-apply-voucher"
                                                    class="font-medium rounded-xl transition-all duration-300 bg-[#020617] text-white border-2 border-[#D4AF37] hover:bg-[#0B1120] hover:shadow-lg hover:shadow-[#D4AF37]/20 px-6 py-3 text-base">
                                                Apply
                                            </button>
                                        </div>
                                        <div id="voucher-success"
                                             class="hidden mt-3 rounded-lg text-sm flex items-center gap-2 border px-3 py-2">
                                            <span>✓</span>
                                            <span>Voucher applied successfully</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Confirm -->
                                <div
                                    class="p-8 bg-[#F9FAFB] rounded-[24px] border border-[#E5E7EB] mb-4">
                                    <p class="text-sm text-[#4B5563] text-center mb-6">
                                        By confirming payment, you agree to all booking terms and
                                        conditions.
                                    </p>

                                    <h:commandButton id="btn-confirm-pay"
                                                     value="Confirm Pay"
                                                     action="#{customerBookingBean.confirmBooking}"
                                                     onclick="return handleConfirmClick();"
                                                     styleClass="w-full mb-4 font-semibold rounded-2xl bg-gradient-to-r from-[#F97316] to-[#EAB308] text-white shadow-[0_18px_45px_rgba(0,0,0,0.45)] shadow-[#D4AF37]/40 border-b-4 border-[#92400E] hover:shadow-[0_20px_55px_rgba(0,0,0,0.6)] hover:shadow-[#FACC6B]/40 hover:from-[#FB923C] hover:to-[#EAB308] hover:-translate-y-0.5 hover:border-[#D97706] focus:outline-none focus:ring-2 focus:ring-[#FACC6B]/60 focus:ring-offset-2 focus:ring-offset-[#020617] transition-transform transition-shadow duration-300 ease-out bg-[#F97316]/90 hover:bg-[#F97316] hover:shadow-[#FACC6B]/30 hover:scale-[1.02] active:scale-[0.98] px-8 py-4 text-lg" />



                                    <button type="button"
                                            class="w-full mb-6 font-medium rounded-xl transition-all duration-300 border-2 border-[#D4AF37] text-[#D4AF37] bg-transparent hover:bg-[#D4AF37]/10 px-8 py-4 text-lg">
                                        Save this quotation
                                    </button>

                                    <div class="flex items-center justify-center gap-6 text-sm">
                                        <button type="button"
                                                class="flex items-center gap-2 text-[#D4AF37] hover:text-[#E6C77F] transition-colors">
                                            <i data-lucide="message-circle"
                                               class="w-4 h-4"></i>
                                            Live chat
                                        </button>
                                        <span class="text-[#E5E7EB]">|</span>
                                        <button type="button"
                                                class="flex items-center gap-2 text-[#D4AF37] hover:text-[#E6C77F] transition-colors">
                                            <i data-lucide="phone"
                                               class="w-4 h-4"></i>
                                            Call consultant
                                        </button>
                                    </div>
                                </div>

                                <div class="flex justify-start pt-2">
                                    <button type="button" id="btn-step3-back"
                                            class="font-medium rounded-xl transition-all duration-300 border-2 border-[#D4AF37] text-[#D4AF37] bg-transparent hover:bg-[#D4AF37]/10 px-6 py-3 text-base">
                                        Back to Guest &amp; Requests
                                    </button>
                                </div>
                            </section>

                        </div>

                        <!-- RIGHT: Booking summary -->
                        <aside class="lg:col-span-5">
                            <div class="sticky top-24">
                                <div
                                    class="bg-white rounded-[24px] shadow-lg border-2 border-[#E5E7EB] overflow-hidden">
                                    <!-- header -->
                                    <div
                                        class="p-6 bg-gradient-to-br from-[#020617] to-[#0B1120] border-b-2 border-[#D4AF37]">
                                        <div class="flex items-start justify-between mb-3">
                                            <div class="flex-1">
                                                <h3 class="text-xl font-bold text-white mb-2"
                                                    id="summary-venue-name">
                                                    <!-- Tên nhà hàng từ DB (CustomerBookingBean đã load restaurant) -->
                                                    <h:outputText value="#{customerBookingBean.restaurantName}" />
                                                </h3>

                                                <div class="flex items-center gap-3 text-sm mb-3">
                                                    <!-- Rating từ RestaurantDetailsBean (đọc review trong DB) -->
                                                    <div class="flex items-center gap-1">
                                                        <i data-lucide="star"
                                                           class="w-4 h-4 text-[#D4AF37] fill-[#D4AF37]"></i>
                                                        <span class="font-medium text-white"
                                                              id="summary-venue-rating">
                                                            <h:outputText value="#{restaurantDetailsBean.avgRating}">
                                                                <f:convertNumber maxFractionDigits="1"
                                                                                 minFractionDigits="1" />
                                                            </h:outputText>
                                                        </span>
                                                    </div>

                                                    <!-- Vị trí: Area, City -->
                                                    <div class="flex items-center gap-1 text-[#E6C77F]">
                                                        <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                        <span id="summary-venue-location">
                                                            <h:panelGroup rendered="#{not empty restaurantDetailsBean.areaName}">
                                                                <h:outputText value="#{restaurantDetailsBean.areaName}" />
                                                            </h:panelGroup>

                                                            <h:panelGroup
                                                                rendered="#{not empty restaurantDetailsBean.areaName and not empty restaurantDetailsBean.cityName}">
                                                                <h:outputText value=", " />
                                                            </h:panelGroup>

                                                            <h:panelGroup rendered="#{not empty restaurantDetailsBean.cityName}">
                                                                <h:outputText value="#{restaurantDetailsBean.cityName}" />
                                                            </h:panelGroup>
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- Badge theo rating (TOP RATED / VIP / NEW) -->
                                                <div class="flex gap-2 flex-wrap" id="summary-venue-tags">
                                                    <h:panelGroup rendered="#{not empty restaurantDetailsBean.badge}">
                                                        <span
                                                            class="px-3 py-1 border border-[#D4AF37] rounded-full text-xs font-medium text-[#E6C77F]">
                                                            <h:outputText value="#{restaurantDetailsBean.badge}" />
                                                        </span>
                                                    </h:panelGroup>
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                    <!-- body -->
                                    <div class="p-6 space-y-5">
                                        <!-- Event date & time -->
                                        <div class="pb-5 border-b border-[#E5E7EB]">
                                            <div
                                                class="flex items-center justify-between text-sm mb-2">
                                                <span class="text-[#4B5563]">Event date &amp; time</span>
                                                <button type="button"
                                                        class="text-[#D4AF37] hover:text-[#E6C77F] transition-colors"
                                                        onclick="BookingUI.goToStep(1)">
                                                    <i data-lucide="edit-2"
                                                       class="w-4 h-4"></i>
                                                </button>
                                            </div>
                                            <div class="flex items-center gap-2 mb-3">
                                                <i data-lucide="calendar"
                                                   class="w-4 h-4 text-[#D4AF37]"></i>
                                                <span class="font-medium text-[#111827]"
                                                      id="summary-event-date">
                                                    19 Nov 2025
                                                </span>
                                            </div>
                                            <p class="text-sm text-[#4B5563]" id="summary-time-slot">
                                                Dinner (18:00–22:00)
                                            </p>
                                        </div>

                                        <!-- Event type & service -->
                                        <div class="pb-5 border-b border-[#E5E7EB]">
                                            <div class="flex items-center justify-between mb-3">
                                                <div>
                                                    <!-- bọc chỗ này bằng h:panelGroup để ajax render -->
                                                    <h:panelGroup id="summaryEventType">
                                                        <span class="block text-sm text-[#6B7280]">Event type</span>
                                                        <p class="text-base font-semibold text-[#111827]">
                                                            <ui:fragment rendered="#{not empty customerBookingBean.selectedEventTypeName}">
                                                                #{customerBookingBean.selectedEventTypeName}
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{empty customerBookingBean.selectedEventTypeName}">
                                                                Not selected
                                                            </ui:fragment>
                                                        </p>
                                                    </h:panelGroup>




                                                </div>
                                                <div class="text-right">
                                                    <p class="text-sm text-[#4B5563]">Service level</p>
                                                    <p class="font-medium text-[#111827] capitalize"
                                                       id="summary-service-level">
                                                        premium
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center gap-2">
                                                    <i data-lucide="users"
                                                       class="w-4 h-4 text-[#D4AF37]"></i>
                                                    <span class="font-semibold text-[#111827]"
                                                          id="summary-table-guest">
                                                        20 tables (~200 guests)
                                                    </span>
                                                </div>
                                                <button type="button"
                                                        class="text-[#D4AF37] hover:text-[#E6C77F] transition-colors"
                                                        onclick="BookingUI.goToStep(1)">
                                                    <i data-lucide="edit-2"
                                                       class="w-4 h-4"></i>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Package -->
                                        <div class="pb-5 border-b border-[#E5E7EB]">
                                            <div class="flex items-start justify-between mb-2">
                                                <div class="flex-1">
                                                    <div class="flex items-center gap-2 mb-1">
                                                        <h4 class="font-semibold text-[#111827]"
                                                            id="summary-package-name">
                                                            Royal Wedding Package
                                                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Price breakdown -->
                                        <div class="space-y-3">
                                            <h5 class="font-semibold text-[#111827] text-sm">Price
                                                breakdown</h5>

                                            <div class="space-y-2 text-sm" id="summary-breakdown">
                                                <div class="flex justify-between">
                                                    <span class="text-[#4B5563]"
                                                          id="summary-package-label">
                                                        Package (20 tables, ~200 guests)
                                                    </span>

                                                    <span class="font-medium text-[#111827]"
                                                          id="summary-package-total">
                                                        $240,000,000
                                                    </span>
                                                </div>
                                                <!-- Custom menu dishes subtotal -->
                                                <h:panelGroup rendered="#{not empty customerBookingBean.selectedMenuItems}">
                                                    <div class="flex justify-between text-sm">
                                                        <span class="text-[#4B5563]">
                                                            Custom menu dishes
                                                        </span>
                                                        <span id="summary-menu-total"
                                                              class="font-medium text-[#111827]">
                                                            $0
                                                        </span>
                                                    </div>
                                                </h:panelGroup>



                                                <div class="flex justify-between" id="summary-service-row">
                                                    <span class="text-[#4B5563]">Service charge</span>
                                                    <span class="font-medium text-[#111827]"
                                                          id="summary-service-charge">
                                                        $5,000,000
                                                    </span>
                                                </div>

                                                <div class="flex justify-between" id="summary-tax-row">
                                                    <span class="text-[#4B5563]">Tax (10%)</span>
                                                    <span class="font-medium text-[#111827]"
                                                          id="summary-tax">
                                                        $24,500,000
                                                    </span>
                                                </div>

                                                <div class="flex justify-between text-[#22C55E] hidden"
                                                     id="summary-discount-row">
                                                    <span>Discount</span>
                                                    <span class="font-medium"
                                                          id="summary-discount">-$0</span>
                                                </div>
                                            </div>

                                            <div class="pt-4 border-t-2 border-[#E5E7EB]">
                                                <div
                                                    class="flex justify-between items-baseline mb-4">
                                                    <span class="text-sm font-medium text-[#4B5563]">Total
                                                        amount</span>
                                                    <span class="text-2xl font-bold text-[#D4AF37]"
                                                          id="summary-total-amount">
                                                        $0
                                                    </span>
                                                </div>

                                                <div
                                                    class="space-y-3 p-4 bg-[#F9FAFB] rounded-xl">
                                                    <div class="flex justify-between">
                                                        <span class="text-sm text-[#4B5563]">
                                                            Deposit to pay now (30%)
                                                        </span>
                                                        <span class="font-semibold text-[#111827]"
                                                              id="summary-deposit">
                                                            $0
                                                        </span>
                                                    </div>
                                                    <div class="text-xs text-[#4B5563]">
                                                        Due within 24 hours after booking
                                                    </div>

                                                    <div class="pt-3 border-t border-[#E5E7EB]">
                                                        <div class="flex justify-between">
                                                            <span class="text-sm text-[#4B5563]">
                                                                Remaining amount
                                                            </span>
                                                            <span class="font-semibold text-[#111827]"
                                                                  id="summary-remaining">
                                                                $0
                                                            </span>
                                                        </div>
                                                        <div class="text-xs text-[#4B5563] mt-1">
                                                            Due 7 days before event
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Status -->
                                        <div class="pt-5 border-t border-[#E5E7EB] space-y-2">
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-[#4B5563]">Booking status</span>
                                                <span
                                                    class="px-3 py-1 bg-[#FACC15]/20 text-[#EAB308] rounded-full text-xs font-semibold">
                                                    Pending
                                                </span>
                                            </div>
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-[#4B5563]">Payment status</span>
                                                <span
                                                    class="px-3 py-1 bg-[#E5E7EB] text-[#4B5563] rounded-full text-xs font-semibold">
                                                    Unpaid
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </div>
                </div>
            </main>
        </h:form>

        <!-- FOOTER -->
        <ui:include src="/layout/footer.xhtml"/>

        <!-- JS: handle steps + pricing -->
        <script type="text/javascript" src="#{request.contextPath}/js/booking.js"></script>

    </h:body>
</html>
