<!DOCTYPE html>
<html lang="vi"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="jakarta.faces.facelets"
        encoding="UTF-8"
        contentType="text/html">

    <h:head>
        <meta charset="UTF-8" />
        <title>FeastLink – Register for Restaurant Account Upgrade</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet"
              type="text/css"
              href="#{request.contextPath}/css/register_manager.css" />

        <!-- Tailwind CDN -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- Lucide Icons CDN -->
        <script src="https://unpkg.com/lucide@latest"></script>
    </h:head>

    <h:body>
        <div id="top"></div>

        <!-- HEADER -->
        <ui:include src="layout/header.xhtml" />

        <div class="shell">

            <!-- SIDEBAR -->
            <aside class="sidebar">
                <div class="logo-row">
                    <h:graphicImage library="images"
                                    name="feastlink-logo.png"
                                    styleClass="logo-mark" />
                    <div>
                        <div class="logo-text-main">FeastLink</div>
                        <div class="logo-text-sub">Banquet &amp; Catering Platform</div>
                    </div>
                </div>

                <div class="sidebar-title">Upgrade your account</div>
                <div class="sidebar-caption">
                    Submit a request to become <span>Restaurant Manager</span> to manage your restaurant's records and party orders.
                </div>

                <div class="sidebar-steps">
                    <a href="#s1" class="sidebar-step-link">
                        <div class="sidebar-step">
                            <div class="step-badge step-badge--active">1</div>
                            <div>
                                    <div class="step-label-main">Management information</div>
                                <div class="step-label-sub">Full name, login email</div>
                            </div>
                        </div>
                    </a>
                    <a href="#s2" class="sidebar-step-link">
                        <div class="sidebar-step">
                            <div class="step-badge">2</div>
                            <div>
                                <div class="step-label-main">Restaurant information</div>
                                <div class="step-label-sub">Name, logo, location</div>
                            </div>
                        </div>
                    </a>
                    <a href="#s3" class="sidebar-step-link">
                        <div class="sidebar-step">
                            <div class="step-badge">3</div>
                            <div>
                                <div class="step-label-main">Party conditions</div>
                                <div class="step-label-sub">Number of guests, date of reservation</div>
                            </div>
                        </div>
                    </a>
                    <a href="#s4" class="sidebar-step-link">
                        <div class="sidebar-step">
                            <div class="step-badge">4</div>
                            <div>
                                <div class="step-label-main">Send to Admin for approval</div>
                                <div class="step-label-sub">Censor &amp; activate</div>
                            </div>
                        </div>
                    </a>
                </div>

                <div class="sidebar-footer">
                   After submitting the request, <span>Admin FeastLink</span> will review and approve within 1–3 business days.
                </div>
            </aside>

            <!-- MAIN CONTENT -->
            <main class="content">
                <div class="content-inner">

                    <!-- JSF GLOBAL MESSAGES -->
                    <h:messages id="globalMsg"
                                layout="list"
                                globalOnly="true"
                                infoClass="msg msg-info msg-lg"
                                errorClass="msg msg-error msg-lg"
                                warnClass="msg msg-warn msg-lg" />

                    <div class="content-header">
                        <div class="content-title-block">
                            <h1>Register to upgrade your Restaurant account</h1>
                            <p>Fill out the information below to request an upgrade of your current account to Restaurant Manager.</p>
                        </div>
                        <div class="status-pill">Status: Draft request</div>
                    </div>

                    <div class="info-banner">
                        <div class="info-text">
                            <strong>Application review process:</strong> After submitting your request, the FeastLink team will review your restaurant information and may contact you for further verification. 
                            (via email or phone). Once your application is approved, your current account will be <strong>upgrade to Restaurant Manager</strong>.
                        </div>
                    </div>

                    <!-- FORM -->
                    <h:form id="registerForm" enctype="multipart/form-data">

                        <!-- 1. THÔNG TIN QUẢN LÝ -->
                        <section class="section-card" id="s1">
                            <div class="section-header">
                                <div>
                                    <div class="section-title">1. Restaurant Management Information</div>
                                        <div class="section-caption">This information is used to log in and receive notifications from FeastLink.</div>
                                </div>
                            </div>

                            <div class="field-grid-2">
                                <div class="field">
                                    <label for="managerName">Manager's name *</label>
                                    <h:inputText id="managerName"
                                                 value="#{registerRestaurantManagerBean.managerName}"
                                                 required="true"
                                                 requiredMessage="Vui lòng nhập Họ và tên quản lý.">
                                        <f:passThroughAttribute name="placeholder" value="Example: Alex Tran" />
                                    </h:inputText>
                                    <h:message for="managerName" styleClass="msg-field-error" />
                                </div>

                                <div class="field">
                                    <label for="managerPhone">Phone number "RESTAURANT ZALO NUMBER" *</label>
                                    <h:inputText id="managerPhone"
                                                 value="#{registerRestaurantManagerBean.managerPhone}"
                                                 required="true"
                                                 requiredMessage="Vui lòng nhập Số điện thoại.">
                                        <f:passThroughAttribute name="placeholder" value="Example: 0901 234 567" />
                                    </h:inputText>
                                    <h:message for="managerPhone" styleClass="msg-field-error" />
                                </div>

                                <div class="field">
                                    <label for="managerEmail">Login Email *</label>
                                    <h:inputText id="managerEmail"
                                                 value="#{registerRestaurantManagerBean.managerEmail}"
                                                 required="true"
                                                 requiredMessage="Vui lòng nhập Email.">
                                        <f:passThroughAttribute name="type" value="email" />
                                        <f:passThroughAttribute name="placeholder" value="example@restaurant.com" />
                                    </h:inputText>
                                    <div class="hint">Will use your current email if you are logged in.</div>
                                    <h:message for="managerEmail" styleClass="msg-field-error" />
                                </div>

                                <div class="field">
                                    <label for="managerRole">Position at the restaurant</label>
                                    <h:inputText id="managerRole"
                                                 value="#{registerRestaurantManagerBean.managerRole}">
                                        <f:passThroughAttribute name="placeholder" value="Example: General Manager" />
                                    </h:inputText>
                                </div>
                            </div>
                        </section>

                        <!-- 2. THÔNG TIN NHÀ HÀNG -->
                        <section class="section-card" id="s2">
                            <div class="section-header">
                                <div>
                                    <div class="section-title">2. Restaurant information</div>
                                    <div class="section-caption">Information displayed to guests when the restaurant is activated on FeastLink.</div>
                                </div>
                            </div>

                            <div class="field-grid-2">
                                <div class="field">
                                    <label for="restaurantName">Restaurant name *</label>
                                    <h:inputText id="restaurantName"
                                                 value="#{registerRestaurantManagerBean.restaurantName}"
                                                 required="true"
                                                 requiredMessage="Please enter Restaurant Name.">
                                        <f:passThroughAttribute name="placeholder" value="Your restaurant name" />
                                    </h:inputText>
                                    <h:message for="restaurantName" styleClass="msg-field-error" />
                                </div>

                                <div class="field">
                                    <label for="restaurantBrandName">Brand name (if any)</label>
                                    <h:inputText id="restaurantBrandName"
                                                 value="#{registerRestaurantManagerBean.restaurantBrandName}">
                                        <f:passThroughAttribute name="placeholder" value="Brand / Group" />
                                    </h:inputText>
                                </div>
                            </div>

                            <div class="field-grid-2 margin-top-12">
                                <div class="field">
                                    <label for="restaurantAddress">Detailed address "Area" *</label>
                                    <h:inputText id="restaurantAddress"
                                                 value="#{registerRestaurantManagerBean.restaurantAddress}"
                                                 required="true"
                                                 requiredMessage="Please enter detailed Address.">
                                        <f:passThroughAttribute name="placeholder" value="House number, street, ward/commune" />
                                    </h:inputText>
                                    <h:message for="restaurantAddress" styleClass="msg-field-error" />
                                </div>

                                <div class="field-grid-2">
                                    <div class="field">
                                        <label for="city">City *</label>
                                        <h:selectOneMenu id="city"
                                                         value="#{registerRestaurantManagerBean.city}"
                                                         required="true"
                                                         requiredMessage="Please select City.">
                                            <f:selectItem itemLabel="Select city" itemValue="" />
                                            <f:selectItems value="#{registerRestaurantManagerBean.cityList}"
                                                           var="c"
                                                           itemLabel="#{c}"
                                                           itemValue="#{c}" />
                                            <f:ajax listener="#{registerRestaurantManagerBean.onCityChange}"
                                                    render="area" />
                                        </h:selectOneMenu>
                                        <h:message for="city" styleClass="msg-field-error" />
                                    </div>

                                    <div class="field">
                                        <label for="area">"Ward" *</label>
                                        <h:selectOneMenu id="area"
                                                         value="#{registerRestaurantManagerBean.area}"
                                                         required="true"
                                                         requiredMessage="Vui lòng chọn Khu vực.">
                                            <f:selectItem itemLabel="Chọn khu vực" itemValue="" />
                                            <f:selectItems value="#{registerRestaurantManagerBean.areaList}"
                                                           var="a"
                                                           itemLabel="#{a}"
                                                           itemValue="#{a}" />
                                        </h:selectOneMenu>
                                        <h:message for="area" styleClass="msg-field-error" />
                                    </div>
                                </div>
                            </div>

                            <div class="field-grid-2 margin-top-12">
                                <div class="field">
                                    <label for="description">Restaurant description</label>
                                    <h:inputTextarea id="description"
                                                     value="#{registerRestaurantManagerBean.description}">
                                        <f:passThroughAttribute name="placeholder"
                                                                value="Brief introduction about the restaurant's style, space and highlights." />
                                    </h:inputTextarea>
                                </div>

                                <!-- UPLOAD LOGO -->
                                <div class="field">
                                    <label for="logoFile">Restaurant logo *</label>
                                    <div class="upload-logo">
                                        <div>Minimum square photo <strong>600 x 600px</strong></div>

                                        <h:inputFile id="logoFile"
                                                     value="#{registerRestaurantManagerBean.logoFile}">
                                        </h:inputFile>
                                        <div class="hint">
                                            Select JPG/PNG file from your computer. The logo will be saved to the folder
                                            <code>resources/images/upload_file</code> of the system.
                                        </div>
                                        <h:message for="logoFile" styleClass="msg-field-error" />

                                        <!-- PREVIEW LOGO -->
                                        <h:panelGroup rendered="#{not empty registerRestaurantManagerBean.logoUrl}">
                                            <div class="logo-preview">
                                                <div class="logo-preview-inner">
                                                    <img src="#{request.contextPath}#{registerRestaurantManagerBean.logoUrl}"
                                                         alt="Logo preview" />
                                                </div>
                                                <div class="logo-preview-caption">
                                                   Logo preview (auto-resize according to frame)
                                                </div>
                                            </div>
                                        </h:panelGroup>
                                    </div>
                                </div>
                            </div>

                            <div class="field-grid-3 margin-top-12">
                                <div class="field">
                                    <label for="openTime">Opening Hours</label>
                                    <h:inputText id="openTime"
                                                 value="#{registerRestaurantManagerBean.openTime}">
                                        <f:passThroughAttribute name="placeholder" value="Example: 09:00" />
                                    </h:inputText>
                                </div>

                                <div class="field">
                                    <label for="closeTime">Closing Hours</label>
                                    <h:inputText id="closeTime"
                                                 value="#{registerRestaurantManagerBean.closeTime}">
                                        <f:passThroughAttribute name="placeholder" value="Example: 22:00" />
                                    </h:inputText>
                                </div>
                            </div>
                        </section>

                        <!-- 3. ĐIỀU KIỆN NHẬN TIỆC -->
                        <section class="section-card" id="s3">
                            <div class="section-header">
                                <div>
                                    <div class="section-title">3. Party conditions (summary)</div>
                                    <div class="section-caption">Set up the basic conditions for FeastLink to make suitable suggestions to customers.</div>
                                </div>
                            </div>

                            <div class="field-grid-3">
                                <div class="field">
                                    <label for="minGuests">Minimum number of guests *</label>
                                    <h:inputText id="minGuests"
                                                 value="#{registerRestaurantManagerBean.minGuests}"
                                                 required="true"
                                                 requiredMessage="Vui lòng nhập Số khách tối thiểu.">
                                        <f:passThroughAttribute name="type" value="number" />
                                        <f:passThroughAttribute name="min" value="0" />
                                        <f:passThroughAttribute name="placeholder" value="Example: 50" />
                                    </h:inputText>
                                    <h:message for="minGuests" styleClass="msg-field-error" />
                                </div>

                                <div class="field">
                                    <label for="maxGuests">Maximum number of guests (expected)</label>
                                    <h:inputText id="maxGuests"
                                                 value="#{registerRestaurantManagerBean.maxGuests}">
                                        <f:passThroughAttribute name="type" value="number" />
                                        <f:passThroughAttribute name="min" value="0" />
                                        <f:passThroughAttribute name="placeholder" value="Example: 300" />
                                    </h:inputText>
                                </div>

                                <div class="field">
                                    <label for="minDays">Minimum number of booking days *</label>
                                    <h:inputText id="minDays"
                                                 value="#{registerRestaurantManagerBean.minDays}"
                                                 required="true"
                                                 requiredMessage="Vui lòng nhập Số ngày đặt trước tối thiểu.">
                                        <f:passThroughAttribute name="type" value="number" />
                                        <f:passThroughAttribute name="min" value="0" />
                                        <f:passThroughAttribute name="placeholder" value="Example: 7" />
                                    </h:inputText>
                                    <div class="hint">Calculated by days before the party date.</div>
                                    <h:message for="minDays" styleClass="msg-field-error" />
                                </div>
                            </div>
                        </section>

                        <!-- 4. ĐIỀU KHOẢN & CAM KẾT -->
                        <section class="section-card" id="s4">
                            <div class="section-header">
                                <div>
                                    <div class="section-title">4. Terms &amp; Commit</div>
                                    <div class="section-caption">Please read the terms carefully before submitting an account upgrade request.</div>
                                </div>
                            </div>

                            <div class="field">
                                <div class="hint" style="margin-bottom:8px;">
                                   When submitting a request to become <strong>Restaurant Manager</strong>On FeastLink, you acknowledge and agree that:
                                </div>
                                <ul class="terms-list">
                                    <li>The restaurant information and contact information you provide is <strong>accurate, complete and up-to-date</strong>.</li>
                                    <li>Your restaurant complies with current legal regulations on<strong>food safety and hygiene, fire prevention and fighting</strong> and related business licenses.</li>
                                    <li>You are responsible for <strong>service quality, menu, price</strong> and customer experience.</li>
                                    <li>You agree to <strong>cancellation/refund policy</strong> and regulations on handling customer complaints and reviews according to FeastLink's regulations.</li>
                                    <li>You authorize FeastLink to use your restaurant information, images and descriptions for<strong>display, promote</strong> on the platform.</li>
                                    <li>FeastLink reserves the right to <strong>review, hide, or unhide </strong> restaurant if found to have false information or policy violations.</li>
                                </ul>
                            </div>

                            <div class="field margin-top-6">
                                <label class="terms-label">
                                    <h:selectBooleanCheckbox id="termsCheckbox"
                                                             value="#{registerRestaurantManagerBean.acceptedTerms}" />
                                    <span>
                                        I confirm that I have read, understood and agree to the Terms &amp; Commitment to
                                        <strong>FeastLink Restaurant Partner</strong>.
                                    </span>
                                </label>
                            </div>
                        </section>

                        <!-- FOOTER BUTTONS -->
                        <div class="form-footer">
                            <div class="security-note">
                                <div class="shield">✓</div>
                                <div>
                                   The request will be sent to Admin FeastLink. The restaurant will only be displayed after being approved. <strong>approve.</strong>
                                </div>
                            </div>
                            <div class="btn-row">
                                <h:commandButton value="Cancel"
                                                 styleClass="btn-secondary"
                                                 action="#{registerRestaurantManagerBean.cancel}" />
                                <h:commandButton id="submitBtn"
                                                 value="Submit an upgrade request"
                                                 styleClass="btn-primary"
                                                 action="#{registerRestaurantManagerBean.submit}" />
                            </div>
                        </div>
                    </h:form>
                </div>

                <!-- FAQ + FOOTER -->
                <div class="faq-wrapper">
                    <div class="faq-card">
                        <div class="faq-title">
                            Frequently asked questions when registering as a FeastLink partner
                        </div>
                        <ul class="faq-list">
                            <li><strong>How long does it take to get approved?</strong>Normally 1–3 business days. If additional documents are required, the FeastLink team will contact you directly.</li>
                            <li><strong>How are restaurants charged/commissioned?</strong> The fixed commission fee is <strong>2% of total party order value</strong> Payment successfully made through FeastLink.</li>
                            <li><strong>Can I edit my restaurant information later?</strong> Yes. Once upgraded, you can update images, menus, prices, banquet halls and booking conditions.</li>
                            <li><strong>When is my restaurant visible to guests?</strong> Once your profile is approved and you configure at least one valid party package/menu, your restaurant will be enabled for visibility.</li>
                        </ul>
                    </div>
                </div>
            </main>
        </div>

        <ui:include src="layout/footer.xhtml" />

        <!-- JS: step highlight, khóa nút nếu chưa tick điều khoản -->
        <script type="text/javascript">
            //<![CDATA[
            function initStepHighlight() {
                var links = document.querySelectorAll('.sidebar-step-link');
                var badges = document.querySelectorAll('.step-badge');

                for (var i = 0; i < links.length; i++) {
                    (function (idx) {
                        links[idx].addEventListener('click', function () {
                            for (var j = 0; j < badges.length; j++) {
                                if (j === idx) {
                                    badges[j].classList.add('step-badge--active');
                                } else {
                                    badges[j].classList.remove('step-badge--active');
                                }
                            }
                        });
                    })(i);
                }
            }

            function initTermsLock() {
                var cb = document.querySelector('input[id$="termsCheckbox"]');
                var btn = document.querySelector('input[id$="submitBtn"]');
                if (!cb || !btn) return;

                function sync() {
                    btn.disabled = !cb.checked;
                    if (btn.disabled) {
                        btn.style.opacity = "0.6";
                        btn.style.cursor = "not-allowed";
                    } else {
                        btn.style.opacity = "1";
                        btn.style.cursor = "pointer";
                    }
                }

                cb.addEventListener('change', sync);
                sync();
            }

            window.addEventListener('load', function () {
                initStepHighlight();
                initTermsLock();
            });
            //]]>
        </script>

    </h:body>
</html>
