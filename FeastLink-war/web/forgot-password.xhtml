<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

<h:head>
    <title>FeastLink – Reset Password</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/auth.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</h:head>

<h:body>
<f:view>
    <div id="top"></div>

    <ui:include src="layout/header.xhtml" />

    <div class="auth-shell">
        <div class="auth-shell-inner">

            <!-- LEFT -->
            <div class="auth-left">
                <div class="auth-left-overlay"></div>
                <div class="auth-left-content">
                    <h:graphicImage library="images" name="feastlink-logo.png" styleClass="auth-logo-mark" />
                    <div class="auth-left-badge">BANQUET EXPERIENCE VISUAL</div>
                    <div class="auth-left-logo">Feast<span>Link</span></div>
                    <div class="auth-left-tagline">Premium Banquet &amp; Catering Booking</div>
                    <p class="auth-left-sub">
                        Reset password by verifying the registered phone number.
                    </p>
                </div>
            </div>

            <!-- RIGHT -->
            <div class="auth-right">
                <div class="auth-card">
                    <h:form id="forgotForm">

                        <div style="display:flex; justify-content:center; margin-bottom:10px;">
                            <h:graphicImage library="images"
                                            name="feastlink-logo.png"
                                            style="width:100px; height:auto; border-radius:999px;" />
                        </div>

                        <div class="auth-title">Reset your password</div>
                        <div class="auth-subtitle">
                            Enter your email + registered phone number, then choose a new password.
                        </div>

                        <!-- Global messages -->
                        <div style="margin-top:10px;font-size:12px;">
                            <h:messages globalOnly="true"
                                        layout="list"
                                        infoClass="msg-info"
                                        errorClass="msg-error"
                                        warnClass="msg-warn" />
                        </div>

                        <div class="auth-form-grid">

                            <!-- Email -->
                            <div>
                                <label class="auth-label" for="email">Email</label>
                                <h:inputText id="email"
                                             value="#{forgotPasswordBean.email}"
                                             required="true"
                                             requiredMessage="Please enter your email."
                                             styleClass="auth-input">
                                    <f:passThroughAttribute name="placeholder" value="Enter your email" />
                                </h:inputText>
                                <h:message for="email" styleClass="msg-error" />
                            </div>

                            <!-- Phone -->
                            <div>
                                <label class="auth-label" for="phone">Phone number</label>
                                <h:inputText id="phone"
                                             value="#{forgotPasswordBean.phone}"
                                             required="true"
                                             requiredMessage="Please enter your phone number."
                                             styleClass="auth-input">
                                    <f:passThroughAttribute name="placeholder" value="Enter registered phone number" />
                                </h:inputText>
                                <!-- ✅ Thông báo “SĐT không đúng với Gmail...” sẽ hiện ở đây -->
                                <h:message for="phone" styleClass="msg-error" />
                            </div>

                            <!-- New Password -->
                            <div>
                                <label class="auth-label" for="newPassword">New password</label>
                                <div class="password-field">
                                    <h:inputSecret id="newPassword"
                                                   value="#{forgotPasswordBean.newPassword}"
                                                   required="true"
                                                   requiredMessage="Please enter a new password."
                                                   styleClass="auth-input"
                                                   maxlength="100">
                                        <f:passThroughAttribute name="placeholder" value="New password" />
                                    </h:inputSecret>
                                    <span class="password-toggle"
                                          data-target="forgotForm:newPassword"
                                          title="Show/Hide password">&#128065;</span>
                                </div>
                                <h:message for="newPassword" styleClass="msg-error" />
                            </div>

                            <!-- Confirm Password -->
                            <div>
                                <label class="auth-label" for="confirmPassword">Confirm new password</label>
                                <div class="password-field">
                                    <h:inputSecret id="confirmPassword"
                                                   value="#{forgotPasswordBean.confirmPassword}"
                                                   required="true"
                                                   requiredMessage="Please confirm your new password."
                                                   styleClass="auth-input"
                                                   maxlength="100">
                                        <f:passThroughAttribute name="placeholder" value="Confirm new password" />
                                    </h:inputSecret>
                                    <span class="password-toggle"
                                          data-target="forgotForm:confirmPassword"
                                          title="Show/Hide password">&#128065;</span>
                                </div>
                                <h:message for="confirmPassword" styleClass="msg-error" />
                            </div>

                        </div>

                        <h:commandButton value="Reset password"
                                         action="#{forgotPasswordBean.resetPassword}"
                                         styleClass="btn-primary" />

                        <div class="auth-footer">
                            Remember your password?
                            <h:link outcome="login" styleClass="auth-link" value="Back to sign in" />
                        </div>

                    </h:form>
                </div>
            </div>

        </div>
    </div>

    <script type="text/javascript">
        //<![CDATA[
        (function () {
            function initPasswordToggles() {
                var toggles = document.querySelectorAll('.password-toggle');
                for (var i = 0; i < toggles.length; i++) {
                    (function (t) {
                        var targetId = t.getAttribute('data-target');
                        var input = document.getElementById(targetId);
                        if (!input) return;

                        t.addEventListener('click', function () {
                            if (input.type === "password") {
                                input.type = "text";
                                t.classList.add('password-toggle--active');
                            } else {
                                input.type = "password";
                                t.classList.remove('password-toggle--active');
                            }
                        });
                    })(toggles[i]);
                }
            }
            window.addEventListener('load', initPasswordToggles);
        })();
        //]]>
    </script>

    <ui:include src="layout/footer.xhtml" />
</f:view>
</h:body>
</html>
