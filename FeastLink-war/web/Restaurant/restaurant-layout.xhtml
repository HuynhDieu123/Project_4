<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:ui="jakarta.faces.facelets">

<h:head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><ui:insert name="title">FeastLink</ui:insert></title>

    <!-- Tailwind + font -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap"
          rel="stylesheet" />

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <script>
        tailwind.config = {
          theme: {
            extend: {
              colors: {
                primary: "#0B1120",
                "background-light": "#F9FAFB",
                "background-soft": "#F5F5F4",
                "card-light": "#FFFFFF",
                "champagne-gold": "#D4AF37",
                "text-main-light": "#111827",
                "text-secondary-light": "#4B5563",
                "border-light": "#E5E7EB",
                "cta-orange": "#F97316",
                "success-green": "#22C55E",
                "error-red": "#EF4444",
              },
              fontFamily: {
                sans: ["Plus Jakarta Sans", "sans-serif"],
              },
              boxShadow: {
                'subtle': '0 4px 12px -2px rgba(20, 20, 20, 0.04)',
              }
            },
          },
        };
    </script>

    <style>
        body { background-color: #F9FAFB; }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0,'wght' 400,'GRAD' 0,'opsz' 24;
        }
    </style>
</h:head>

<h:body class="font-sans bg-background-light text-text-main-light">
    <div class="flex flex-col min-h-screen">

        <!-- TOP BAR -->
        <header class="sticky top-0 z-10 flex items-center justify-between h-20 px-8 bg-card-light border-b border-border-light shadow-sm">

            <!-- Bên trái: mỗi page tự define -->
            <ui:insert name="header" />

            <!-- Bên phải: New Booking + notifications + profile + LOGOUT -->
            <!-- Dùng h:form để gọi action logout -->
            <h:form styleClass="flex items-center space-x-6">

                <!-- Thông tin user -->
                <div class="flex items-center space-x-3">
                        <!-- Avatar: lấy từ sessionScope.currentUser.avatarUrl -->
                        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden">
                            <!-- Có avatar -->
                            <ui:fragment rendered="#{sessionScope.currentUser ne null
                                                     and not empty sessionScope.currentUser.avatarUrl}">
                                <img alt="Restaurant manager profile picture"
                                     class="w-10 h-10 rounded-full object-cover"
                                     src="#{sessionScope.currentUser.avatarUrl}" />
                            </ui:fragment>

                            <!-- Không có avatar: icon mặc định -->
                            <ui:fragment rendered="#{sessionScope.currentUser eq null
                                                     or empty sessionScope.currentUser.avatarUrl}">
                                <span class="material-symbols-outlined text-gray-500">
                                    account_circle
                                </span>
                            </ui:fragment>
                        </div>

                        <div>
                            <!-- Lấy tên từ sessionScope.currentUser -->
                            <p class="font-semibold text-sm text-text-main-light">
                                #{empty sessionScope.currentUser ? 'Manager' : sessionScope.currentUser.fullName}
                            </p>
                            <p class="text-xs text-text-secondary-light">
                                Restaurant Manager
                            </p>
                        </div>
                    </div>

                <!-- Nút LOGOUT -->
                <h:commandLink action="#{authBean.logout}"
                               styleClass="inline-flex items-center text-xs font-medium text-text-secondary-light border border-border-light rounded-full px-3 py-1.5 hover:bg-background-soft hover:text-text-main-light transition">
                    <span class="material-symbols-outlined text-sm mr-1">logout</span>
                    Logout
                </h:commandLink>

            </h:form>
        </header>

        <!-- MAIN CONTENT -->
        <main class="flex-1">
            <div class="p-8">
                <ui:insert name="content" />
            </div>
        </main>
    </div>
</h:body>
</html>
